div(ng-include='\'partials/navbar.html\'')
alert(ng-repeat="alert in alerts" type="alert.type" close="closeAlert($index)") {{alert.msg}}
.idea(ng-repeat="idea in ideas")
  h1 {{idea.title}}
    span.mergeStatus(ng-show='idea.root' ng-class='{merged: idea.branch_status.isMerged}') 
      | {{idea.branch_status.isMerged? "Merged" : "Unmerged"}}
  .idea-summary {{idea.summary}}
    div(ng-show='(idea.root)&&(!idea.branch_status.isMerged)' ng-animate=" 'animate' ")
      progressbar(max="100" value="idea.votePercent")
      button.btn.btn-primary(ng-click='vote(idea)' btn-checkbox ng-model='idea.novote') Vote
  .root(ng-show='idea.root') 
    h2 Root
    a(href='/idea/{{idea.root._id}}') {{idea.root.title}}
  .branches(ng-show='idea.mergedBranches.length + idea.unmergedBranches.length > 0')
    h2 Branches
    h3(ng-show='idea.mergedBranches.length > 0') Merged
    accordion.mergedBranches(close-others="true")
      accordion-group.branch(ng-repeat='branch in idea.mergedBranches' heading='{{branch.title}}')
        p {{branch.summary}}
        a(href='/idea/{{branch._id}}') Link
    h3(ng-show='idea.unmergedBranches.length > 0') Unmerged
    accordion.unmergedBranches(close-others="true")
      accordion-group.branch(ng-repeat='branch in idea.unmergedBranches' heading='{{branch.title}}')
        p {{branch.summary}}
        a(href='/idea/{{branch._id}}') Link
        progressbar.small(max="100" value="branch.votePercent")
  .comments(ng-if="single")
    h3 Comments
    .comment(ng-repeat="comment in comments" ng-class="{deleted: comment.deleted}")
      .comment-content(ng-if="!comment.editing") {{comment.comment}}
      textarea(msd-elastic rows="1" ng-if="comment.editing" ng-model="comment.comment" ng-change="comment.change()")
      .comment-owner 
        img(src="http://gravacat.trevorfenn.info/{{comment.profile.emailHash}}")
        a(href="/user/{{comment.owner}}") {{comment.profile.name}}
      .comment-date &nbsp;&nbsp;&mdash;&nbsp;&nbsp;{{comment.created | date: 'short'}}
      .comment-edited(ng-if="comment.edited") edited
      a.comment-edit(ng-if="comment.editable" ng-click="comment.edit()") {{comment.editStatus}}
      a.comment-edit(ng-if="comment.editable && comment.editStatus == 'submit'" ng-click="comment.cancel()") cancel
      a.comment-edit(ng-if="comment.deleteable" ng-click="comment.delete()") delete
    form.new-comment(role="form")
      .form-group
        textarea.form-control(rows="2" msd-elastic ng-model="newComment.comment" ng-if="newComment.active")
        .comment-btns
          button.btn.btn-comment.btn-primary(ng-click="newComment.submit()" ng-if="newComment.active") Submit
          button.btn.btn-comment(ng-click="newComment.active = !newComment.active" ng-class="newComment.active ? 'btn-danger' : 'btn-primary'") {{newComment.active ? "Cancel" : "Comment"}}
pagination(ng-if="numPages > 1" total-items="totalIdeas" page="page" max-size="5" class="pagination-sm" boundary-links="true" rotate="true" items-per-page="ideasPer" on-select-page = "switchPage(page)")